8000 R3#=LEN(E$): XFLG#=0
8010 PRINT TAB(R#,C#);E$;TAB(R#,C#+R3#);"<<<";TAB(R#,C#);CHR$(7);
8020 R6#=1:KEY$=INCHAR$
8030 IF INSTAT THEN 8050
8040 GOTO 8030
8050 KEY$=INCHAR$
8060 ON INDEX(EDTK$,KEY$) GOTO @LBRK,@LBRK,@RBRK,@LBRC,@RBRC,@RUB,@CR,@ESC
8070 IF KEY$<" " OR KEY$>"}" THEN PRINT CHR$(7);:GOTO 8030
8080 @NORMALCHAR
8090 MID$(E$,R6#)=KEY$
8100 PRINT KEY$;
8110 @RBRK
8120 R6#=R6#+(R6#<R3#)
8130 GOTO @NXTCHR
8140 @BS
8150 MID$(E$,R6#)=" "
8160 PRINT " ";
8170 @LBRK
8180 R6#=R6#-(R6#>1)
8190 GOTO @NXTCHR
8200 @RBRC
8210 MID$(E$,R6#)=" "+MID$(E$,R6#,30)
8220 GOTO @REDISP
8230 @LBRC
8240 MID$(E$,R6#)=MID$(E$,R6#+1,R3#-R6#)+" "
8250 GOTO @REDISP
8260 @RUB
8270 MID$(E$,R6#)=SPC$(30)
8280 @REDISP
8290 PRINT MID$(E$,R6#,R3#-R6#+1);
8300 @NXTCHR
8310 PRINT TAB(R#,C#+R6#-1);
8320 GOTO 8030
8330 @ESC : XFLG#=1
8340 @CR
8350 PRINT TAB(R#,C#+R3#);SPC$(3);
8360 IF INP# THEN E$=MID$(E$,1,INDEX(E$+"   ","   ")-1)
8370 RETURN
9000 PRINT TAB(24,1);CHR$(7);"!! Error (";ERR;") @ Line #";ERRLINE;
9010 CLOSE
9020 STOP
X(E$+"   ","   ")-1)
8370 RETURN
9000 PRINT TAB(24,1);CHR$(7);"!! Error (";ERR;") @ Line #